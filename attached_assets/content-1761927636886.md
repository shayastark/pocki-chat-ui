[Skip to main content](https://docs.base.org/mini-apps/core-concepts/notifications#content-area)

[Base Documentation home page![light logo](https://mintcdn.com/base-a060aa97/nnaK9UEOgZ1ZSTpu/logo/logo_light.svg?fit=max&auto=format&n=nnaK9UEOgZ1ZSTpu&q=85&s=0b270f2aae45e381865e49183be66829)![dark logo](https://mintcdn.com/base-a060aa97/nnaK9UEOgZ1ZSTpu/logo/logo_dark.svg?fit=max&auto=format&n=nnaK9UEOgZ1ZSTpu&q=85&s=a53ba31459651eba4826c89d864cdf12)](https://docs.base.org/)

Search...

Ctrl K

Search...

Navigation

Core Concepts

Notifications

[Get Started](https://docs.base.org/get-started/base) [Base Chain](https://docs.base.org/base-chain/quickstart/why-base) [Base Account](https://docs.base.org/base-account/overview/what-is-base-account) [Base App](https://docs.base.org/base-app/introduction/beta-faq) [Mini Apps](https://docs.base.org/mini-apps/quickstart/migrate-existing-apps) [OnchainKit](https://docs.base.org/onchainkit/latest/getting-started/overview) [Cookbook](https://docs.base.org/cookbook/onboard-any-user) [Showcase](https://docs.base.org/showcase) [Learn](https://docs.base.org/learn/welcome)

![notification-image-iphone](https://mintcdn.com/base-a060aa97/uEmvHrTbmfeJo9n_/images/minikit/notifications-sample.png?fit=max&auto=format&n=uEmvHrTbmfeJo9n_&q=85&s=52a08c64b48c40d8118d2b32ee4ba3c9)

Notification tokens are unique to each client app. This means a user can have separate notification preferences for your Mini App across different clients (e.g., Farcaster, the Base app). Removing your Mini App in one client does not affect its status in other clients.

![notification-image-iphone](https://mintcdn.com/base-a060aa97/uEmvHrTbmfeJo9n_/images/minikit/notifications-sample.png?fit=max&auto=format&n=uEmvHrTbmfeJo9n_&q=85&s=52a08c64b48c40d8118d2b32ee4ba3c9)

Notification tokens are unique to each client app. This means a user can have separate notification preferences for your Mini App across different clients (e.g., Farcaster, the Base app). Removing your Mini App in one client does not affect its status in other clients.

## [​](https://docs.base.org/mini-apps/core-concepts/notifications\#overview)  Overview

When a user enables notifications for your Mini App, the Base app generates a unique notification `token` and `url` which is sent to your server via webhook.This `token` grants your app permission to send in-app notifications to that specific user.To send a notification, make a `POST` request to the `url` with the user’s notification `token` and your content.You will receive webhook events when users enable or disable notifications for your app. When disabled, the notification token becomes invalid and should no longer be used.

## [​](https://docs.base.org/mini-apps/core-concepts/notifications\#client-app-behavior)  Client App Behavior

Different client apps handle webhook responses differently:**Farcaster app**: Activates notification tokens immediately without waiting for a webhook success response.**Base app**: Waits for a successful webhook response before activating tokens.

If your webhook processes token saving and sends notifications synchronously before returning a response, tokens may work on Farcaster but fail to activate on Base app.

## [​](https://docs.base.org/mini-apps/core-concepts/notifications\#implementation)  Implementation

1

Create a webhook server

Create a webhook server to handle webhook events.

The `data` object returned by `parseWebhookEvent` contains three key fields:

- **`fid`**: The user’s FID
- **`appFid`**: The client’s FID (the Base app is 309857)
- **`event`**: The event payload with type and notification details

Always use both `fid` and `appFid` together to identify a unique user-client combination.

app/api/webhook/route.ts

Report incorrect code

Copy

Ask AI

```

import {
  parseWebhookEvent,
  verifyAppKeyWithNeynar,
} from "@farcaster/miniapp-node";

export async function POST(request: NextRequest) {
  const requestJson = await request.json();

  // Parse and verify the webhook event
  let data;
  try {
    data = await parseWebhookEvent(requestJson, verifyAppKeyWithNeynar);
    // Events are signed by the app key of a user with a JSON Farcaster Signature.
  } catch (e: unknown) {
    // Handle verification errors (invalid data, invalid app key, etc.)
    // Return appropriate error responses with status codes 400, 401, or 500
  }

  // Extract webhook data

  const fid = data.fid;
  const appFid = data.appFid; // The FID of the client app that the user added the Mini App to
  const event = data.event;

// Handle different event types

try {
  switch (event.event) {
    case "miniapp_added":
      if (event.notificationDetails) {
       setUserNotificationDetails(fid, appFid, event.notificationDetails);
       sendMiniAppNotification(fid, appFid, "Welcome to Base Mini Apps", "Mini app is now added to your client");
          fid,
          appFid,
          title: "Welcome to Base Mini Apps",
          body: "Mini app is now added to your client",
        });
      }
      break;

    case "miniapp_removed":
     // Delete notification details
      await deleteUserNotificationDetails(fid, appFid);
      break;

    case "notifications_enabled":
      // Save new notification details and send confirmation
       setUserNotificationDetails(fid, appFid, event.notificationDetails);
       sendMiniAppNotification({
        fid,
        appFid,
        title: "Ding ding ding",
        body: "Notifications are now enabled",
      });
      break;

    case "notifications_disabled":
         // Delete notification details
      await deleteUserNotificationDetails(fid, appFid);
      break;
  }
} catch (error) {
  console.error("Error processing webhook:", error);
}

    return response;


```

See all 69 lines

2

Add the Webhook URL to your manifest

Add the Webhook URL to your manifest file

app/.well-known/farcaster.json

Report incorrect code

Copy

Ask AI

```
{
  "accountAssociation": {
    "header": "eyJmaWQiOjU0NDgsInR5cGUiOiJjdXN0b2R5Iiwia2V5IjoiMHg2MWQwMEFENzYwNjhGOEQ0NzQwYzM1OEM4QzAzYUFFYjUxMGI1OTBEIn0",
    "payload": "eyJkb21haW4iOiJleGFtcGxlLmNvbSJ9",
    "signature": "MHg3NmRkOWVlMjE4OGEyMjliNzExZjUzOTkxYTc1NmEzMGZjNTA3NmE5OTU5OWJmOWFmYjYyMzAyZWQxMWQ2MWFmNTExYzlhYWVjNjQ3OWMzODcyMTI5MzA2YmJhYjdhMTE0MmRhMjA4MmNjNTM5MTJiY2MyMDRhMWFjZTY2NjE5OTFj"
  },
  "miniapp": {
    "version": "1",
    "name": "Example App",
    "iconUrl": "https://example.com/icon.png",
    "homeUrl": "https://example.com",
    "imageUrl": "https://example.com/image.png",
    "buttonTitle": "Check this out",
    "splashImageUrl": "https://example.com/splash.png",
    "splashBackgroundColor": "#eeccff",
    "webhookUrl": "https://example.com/api/webhook"
  }
}

```

3

Prompt users to add your Mini App

Use the `addMiniApp()` hook to prompt users to add your Mini App

**Important: Webhook Response Timing**
Webhooks must respond within 10 seconds to avoid timeouts from the Base app. If you encounter a “Failed to add mini app” error, your webhook may be taking too long to respond.

page.tsx

Report incorrect code

Copy

Ask AI

```
"use client";

import { sdk } from "@farcaster/miniapp-sdk";
import { useCallback, useState } from "react";

export default function AddMiniApp() {
  const [result, setResult] = useState("");

  const handleAddMiniApp = useCallback(async () => {
    try {
      const response = await sdk.actions.addMiniApp();

      if (response.notificationDetails) {
        setResult("Mini App added with notifications enabled!");
      } else {
        setResult("Mini App added without notifications");
      }
    } catch (error) {
      setResult(`Error: ${error}`);
    }
  }, []);

  return (
    <div>
      <button onClick={handleAddMiniApp}>
        Add Mini App
      </button>
      {result && <p>{result}</p>}
    </div>
  );
}

```

4

Save the token and URL from the webhook event

The `token` and `url` need to be securely saved to a database so they can be looked up when you want to send a notification to a particular user.

miniapp\_added\_payload.json

Report incorrect code

Copy

Ask AI

```
{
  "event": "notifications_enabled",
  "notificationDetails": {
    "url": "https://api.farcaster.xyz/v1/frame-notifications",
    "token": "a05059ef2415c67b08ecceb539201cbc6"
  }
}

```

5

Send notifications

Send notifications by sending a `POST` request to the `url` associated with the user’s `token`

sendNotification.ts

Report incorrect code

Copy

Ask AI

```
export async function sendMiniAppNotification({
  fid,
  appFid,
  title,
  body,
}: {
  fid: number;
  appFid: number;
  title: string;
  body: string;
}): Promise<sendMiniAppNotificationResult> {
  const notificationDetails = await getUserNotificationDetails(fid, appFid);
  if (!notificationDetails) {
    return { state: "no_token" };
  }

  const response = await fetch(notificationDetails.url, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      notificationId: crypto.randomUUID(),
      title,
      body,
      targetUrl: appUrl,
      tokens: [notificationDetails.token],
    } satisfies SendNotificationRequest),
  });

  const responseJson = await response.json();

  if (response.status === 200) {
    const responseBody = sendNotificationResponseSchema.safeParse(responseJson);
    if (responseBody.success === false) {
      // Malformed response
      return { state: "error", error: responseBody.error.errors };
    }

    if (responseBody.data.result.rateLimitedTokens.length) {
      // Rate limited
      return { state: "rate_limit" };
    }

    return { state: "success" };
  } else {
    // Error response
    return { state: "error", error: responseJson };
  }
}

```

## [​](https://docs.base.org/mini-apps/core-concepts/notifications\#schema)  Schema

### [​](https://docs.base.org/mini-apps/core-concepts/notifications\#send-notification-request-schema)  Send Notification Request Schema

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-notification-id)

notificationId

string

required

Identifier that is combined with the FID to form an idempotency key. When the user opens the Mini App from the notification this ID will be included in the context object. **Maximum length of 128 characters.**

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-title)

title

string

required

Title of the notification. **Max length 32 characters.**

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-body)

body

string

required

Body of the notification. **Max length 128 characters.**

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-target-url)

targetUrl

string

required

URL to open when the user clicks the notification. **Max length 1024 characters.**

Must be on the same domain as the Mini App.

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-tokens)

tokens

string\[\]

required

Array of notification tokens to send to. **Max 100 tokens.**

### [​](https://docs.base.org/mini-apps/core-concepts/notifications\#send-notification-response-schema)  Send Notification Response Schema

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-successful-tokens)

successfulTokens

string\[\]

required

Tokens for which the notification succeeded.

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-invalid-tokens)

invalidTokens

string\[\]

required

Tokens which are no longer valid and should never be used again. This could happen if the user disabled notifications but for some reason the Mini App server has no record of it.

[​](https://docs.base.org/mini-apps/core-concepts/notifications#param-rate-limited-tokens)

rateLimitedTokens

string\[\]

required

Tokens for which the rate limit was exceeded. The Mini App server can try later.

## [​](https://docs.base.org/mini-apps/core-concepts/notifications\#events)  Events

Mini App events use the following object structure:

- **`type`**: notification event type
- **`notificationDetails.url`**: URL that the app should call to send a notification.
- **`notificationDetails.token`**: A secret token generated by the Base app and shared with the Notification Server. A token is unique for each (Farcaster Client, Mini App, user Fid) tuple.

If users are not seeing the option to enable notifications when they call `addMiniApp()`, verify that your manifest file contains a valid `webhookUrl`.

### [​](https://docs.base.org/mini-apps/core-concepts/notifications\#miniapp-added)  `miniapp_added`

Sent when the user adds the Mini App to their Farcaster client (whether or not it was triggered by an `addMiniApp()` prompt).

miniapp\_added\_payload.json

Report incorrect code

Copy

Ask AI

```
{
  "event": "miniapp_added",
  "notificationDetails": {
    "url": "https://api.farcaster.xyz/v1/frame-notifications",
    "token": "a05059ef2415c67b08ecceb539201cbc6"
  }
}

```

### [​](https://docs.base.org/mini-apps/core-concepts/notifications\#miniapp-removed)  `miniapp_removed`

Sent when a user removes the Mini App, which means that any notification tokens for that FID and client app (based on signer requester) should be considered invalid:

miniapp\_removed\_payload

Report incorrect code

Copy

Ask AI

```
{
  "event": "miniapp_removed"
}

```

### [​](https://docs.base.org/mini-apps/core-concepts/notifications\#notifications-enabled)  `notifications_enabled`

Sent when a user enables notifications (e.g. after disabling them). The payload includes a new `token` and `url`:

notifications\_enabled\_payload

Report incorrect code

Copy

Ask AI

```
{
  "event": "notifications_enabled",
  "notificationDetails": {
    "url": "https://api.farcaster.xyz/v1/frame-notifications",
    "token": "a05059ef2415c67b08ecceb539201cbc6"
  }
}

```

### [​](https://docs.base.org/mini-apps/core-concepts/notifications\#notifications-disabled)  `notifications_disabled`

Sent when a user disables notifications from, e.g., a settings panel in the client app. Any notification tokens for that FID and client app (based on signer requester) should be considered invalid:

notifications\_disabled\_json

Report incorrect code

Copy

Ask AI

```
{
  "event": "notifications_disabled"
}

```

Was this page helpful?

YesNo

[Suggest edits](https://github.com/base/docs/edit/master/docs/mini-apps/core-concepts/notifications.mdx) [Raise issue](https://github.com/base/docs/issues/new?title=Issue%20on%20docs&body=Path:%20/mini-apps/core-concepts/notifications)

[Base Account](https://docs.base.org/mini-apps/core-concepts/base-account) [Authentication](https://docs.base.org/mini-apps/core-concepts/authentication)

Ctrl+I

Assistant

Responses are generated using AI and may contain mistakes.

![notification-image-iphone](https://mintcdn.com/base-a060aa97/uEmvHrTbmfeJo9n_/images/minikit/notifications-sample.png?w=840&fit=max&auto=format&n=uEmvHrTbmfeJo9n_&q=85&s=3e85b240831799970c2d8ae0787caa85)

![notification-image-iphone](https://mintcdn.com/base-a060aa97/uEmvHrTbmfeJo9n_/images/minikit/notifications-sample.png?w=840&fit=max&auto=format&n=uEmvHrTbmfeJo9n_&q=85&s=3e85b240831799970c2d8ae0787caa85)